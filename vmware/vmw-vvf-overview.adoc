---
sidebar: sidebar 
permalink: vmware/vmw-vvf-overview.html 
keywords: netapp, vmware, cloud, foundation, vcf, asa, all-flash, san, nfs, vvol, vvols, array, ontap tools, otv, sddc, iscsi, fc, fibre channel, nvme 
summary:  
---
= 了解如何在 VMware vSphere 8 的ONTAP存储系统上使用 NFS v3 数据存储
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
NetApp ONTAP和 VMware vSphere 8 协同工作，使用NetApp全闪存阵列为混合云环境提供可扩展且安全的基于 NFS v3 的存储解决方案。了解 VMware vSphere Foundation 支持的存储选项和主要用例，包括用于灾难恢复的 VMware Live Site Recovery 和用于 NFS 存储的 NetApp 自主勒索软件防护 (ARP)。



== 将 NFS v3 与 vSphere 8 和ONTAP存储系统结合使用

本文档提供有关使用NetApp全闪存阵列的 VMware Cloud vSphere Foundation 可用的存储选项的信息。支持的存储选项包含有关部署 NFS 数据存储的具体说明。此外，还演示了用于 NFS 数据存储灾难恢复的 VMware Live Site Recovery。最后，回顾了 NetApp 针对 NFS 存储的自主勒索软件防护。



=== 使用案例

本文档涵盖的用例：

* 为寻求跨私有云和公共云的统一环境的客户提供存储选项。
* 为工作负载部署虚拟基础设施。
* 可扩展的存储解决方案可满足不断变化的需求，即使与计算资源需求不直接相关。
* 使用适用SnapCenter Plug-in for VMware vSphere保护虚拟机和数据存储区。
* 使用 VMware Live Site Recovery 对 NFS 数据存储进行灾难恢复。
* 勒索软件检测策略，包括 ESXi 主机和客户 VM 级别的多层保护。




=== 受众

此解决方案适用于以下人群：

* 解决方案架构师正在为 VMware 环境寻找更灵活的存储选项，以最大程度地提高 TCO。
* 解决方案架构师正在寻找能够为主要云提供商提供数据保护和灾难恢复选项的 VVF 存储选项。
* 存储管理员希望获得有关如何使用 NFS 存储配置 VVF 的具体指导。
* 存储管理员希望获得有关如何保护ONTAP存储上的虚拟机和数据存储区的具体说明。




== 技术概述

vSphere 8 的 NFS v3 VVF 参考指南由以下主要组件组成：



=== VMware vSphere 基金会

VMware vCenter 是 vSphere Foundation 的核心组件，它是一个集中式管理平台，用于提供 vSphere 环境的配置、控制和管理。vCenter 是管理虚拟化基础架构的基础，允许管理员在虚拟环境中部署、监控和管理虚拟机、容器和 ESXi 主机。

VVF 解决方案支持原生 Kubernetes 和基于虚拟机的工作负载。关键组件包括：

* VMware vSphere
* VMware vSAN
* Aria 标准
* 适用于 vSphere 的 VMware Tanzu Kubernetes Grid 服务
* vSphere 分布式交换机


有关 VVF 所含组件的更多信息，请参阅架构和规划，请参阅 https://www.vmware.com/docs/vmw-datasheet-vsphere-product-line-comparison["VMware vSphere 产品实时比较"]。



=== VVF 存储选项

成功且强大的虚拟环境的核心是存储。无论是通过 VMware 数据存储区还是通过来宾连接的用例进行存储，都可以释放您的工作负载的功能，因为您可以选择每 GB 的最佳价格，以提供最大的价值，同时减少利用不足。近二十年来， ONTAP一直是 VMware vSphere 环境的领先存储解决方案，并不断添加创新功能以简化管理并降低成本。

VMware 存储选项通常分为传统存储和软件定义存储产品。传统存储模型包括本地存储和网络存储，而软件定义存储模型包括 vSAN 和 VMware 虚拟卷 (vVols)。

image:vmware-nfs-overview-001.png["虚拟机存储选项"]{nbsp}

参考 https://techdocs.broadcom.com/us/en/vmware-cis/vsphere/vsphere/8-0/vsphere-storage-8-0/introduction-to-storage-in-vsphere-environment.html["vSphere 环境中的存储简介"]有关 VMware vSphere Foundation 支持的存储类型的更多信息。



=== NetApp ONTAP

数以万计的客户选择ONTAP作为 vSphere 的主要存储解决方案，有许多令人信服的理由。其中包括：

. *统一存储系统*： ONTAP提供支持 SAN 和 NAS 协议的统一存储系统。这种多功能性允许在单一解决方案中无缝集成各种存储技术。
. *强大的数据保护：* ONTAP通过节省空间的快照提供强大的数据保护功能。这些快照可实现高效的备份和恢复过程，确保应用程序数据的安全性和完整性。
. *全面的管理工具*： ONTAP提供了丰富的工具，旨在帮助有效地管理应用程序数据。这些工具简化了存储管理任务，提高了运营效率并简化了管理。
. *存储效率：* ONTAP包含多个默认启用的存储效率功能，旨在优化存储利用率、降低成本并提高整体系统性能。


当满足特定的应用程序需求时，将ONTAP与 VMware 结合使用可提供极大的灵活性。使用ONTAP支持以下协议作为 VMware 数据存储：* FCP * FCoE * NVMe/FC * NVMe/TCP * iSCSI * NFS v3 * NFS v4.1

使用与虚拟机管理程序分离的存储系统允许您卸载许多功能并最大化您对 vSphere 主机系统的投资。这种方法不仅可以确保您的主机资源专注于应用程序工作负载，还可以避免存储操作对应用程序的随机性能产生影响。

ONTAP与 vSphere 结合使用是一种很好的组合，可以让您减少主机硬件和 VMware 软件的费用。您还可以以较低的成本保护您的数据并保持始终如一的高性能。由于虚拟化工作负载是移动的，您可以探索使用 Storage vMotion 的不同方法在同一存储系统上跨 VMFS、NFS 或vVols数据存储移动虚拟机。



=== NetApp全闪存阵列

NetApp AFF （All Flash FAS）是全闪存存储阵列的产品线。它旨在为企业工作负载提供高性能、低延迟的存储解决方案。  AFF系列将闪存技术的优势与 NetApp 的数据管理功能相结合，为企业提供强大而高效的存储平台。

AFF系列包括 A 系列和 C 系列型号。

NetApp A 系列全 NVMe 闪存阵列专为高性能工作负载而设计，提供超低延迟和高弹性，适用于关键任务应用程序。

image:vmware-nfs-overview-002.png["AFF阵列"]{nbsp}

C 系列 QLC 闪存阵列针对更高容量的用例，提供闪存的速度和混合闪存的经济性。

image:vmware-nfs-overview-003.png["C系列阵列"]



==== 存储协议支持

AFF支持用于虚拟化的所有标准协议，包括数据存储和客户机连接存储，包括 NFS、SMB、iSCSI、光纤通道 (FC)、以太网光纤通道 (FCoE)、NVME over fabrics 和 S3。客户可以自由选择最适合其工作负载和应用程序的解决方案。

*NFS* - NetApp AFF提供对 NFS 的支持，允许基于文件访问 VMware 数据存储。许多 ESXi 主机的 NFS 连接数据存储远远超出了对 VMFS 文件系统施加的限制。将 NFS 与 vSphere 结合使用可提供一些易用性和存储效率可见性优势。 ONTAP包括适用于 NFS 协议的文件访问功能。您可以启用 NFS 服务器并导出卷或 qtree。

有关 NFS 配置的设计指导，请参阅 https://docs.netapp.com/us-en/ontap/nas-management/index.html["NAS 存储管理文档"]。

*iSCSI* - NetApp AFF为 iSCSI 提供强大的支持，允许通过 IP 网络对存储设备进行块级访问。它提供与 iSCSI 启动器的无缝集成，从而实现 iSCSI LUN 的高效配置和管理。  ONTAP 的高级功能，例如多路径、CHAP 身份验证和 ALUA 支持。

有关 iSCSI 配置的设计指导，请参阅 https://docs.netapp.com/us-en/ontap/san-config/configure-iscsi-san-hosts-ha-pairs-reference.html["SAN 配置参考文档"]。

*光纤通道* - NetApp AFF为光纤通道 (FC) 提供全面支持，光纤通道是一种常用于存储区域网络 (SAN) 的高速网络技术。 ONTAP与 FC 基础架构无缝集成，提供可靠、高效的存储设备块级访问。它提供分区、多路径和结构登录（FLOGI）等功能，以优化性能、增强安全性并确保 FC 环境中的无缝连接。

有关光纤通道配置的设计指导，请参阅 https://docs.netapp.com/us-en/ontap/san-config/configure-fc-nvme-hosts-ha-pairs-reference.html["SAN 配置参考文档"]。

*NVMe over Fabrics* - NetApp ONTAP支持 NVMe over fabrics。  NVMe/FC 支持通过光纤通道基础设施使用 NVMe 存储设备，并通过存储 IP 网络使用 NVMe/TCP。

有关 NVMe 的设计指导，请参阅 https://docs.netapp.com/us-en/ontap/nvme/support-limitations.html["NVMe 配置、支持和限制"]。



==== 双活技术

NetApp全闪存阵列允许通过两个控制器实现主动-主动路径，从而无需主机操作系统等待主动路径发生故障后再激活备用路径。这意味着主机可以利用所有控制器上的所有可用路径，确保无论系统处于稳定状态还是正在进行控制器故障转移操作，活动路径始终存在。

有关详细信息，请参阅 https://docs.netapp.com/us-en/ontap/data-protection-disaster-recovery/index.html["数据保护和灾难恢复"]文档。



==== 存储保证

NetApp通过NetApp全闪存阵列提供一套独特的存储保证。其独特的优势包括：

*存储效率保证：*通过存储效率保证，在最大限度地降低存储成本的同时实现高性能。对于 SAN 工作负载而言，比例为 4:1。  *勒索软件恢复保证：*在发生勒索软件攻击时保证数据恢复。

有关详细信息，请参阅 https://www.netapp.com/data-storage/aff-a-series/["NetApp AFF登录页面"]。



=== 适用于 VMware vSphere 的NetApp ONTAP工具

vCenter 的一个强大组件是能够集成插件或扩展，从而进一步增强其功能并提供额外的特性和能力。这些插件扩展了 vCenter 的管理功能，并允许管理员将第三方解决方案、工具和服务集成到他们的 vSphere 环境中。

NetApp ONTAP工具 for VMware 是一套全面的工具，旨在通过其 vCenter 插件架构促进 VMware 环境中的虚拟机生命周期管理。这些工具与 VMware 生态系统无缝集成，可实现高效的数据存储配置并为虚拟机提供必要的保护。借助适用于 VMware vSphere 的ONTAP工具，管理员可以轻松管理存储生命周期管理任务。

全面的ONTAP工具 10 个资源可供查找 https://docs.netapp.com/us-en/ontap-tools-vmware-vsphere-10/index.html["ONTAP tools for VMware vSphere文档资源"]。

查看ONTAP Tools 10 部署解决方案link:vmw-nfs-otv10.html["使用ONTAP工具 10 为 vSphere 8 配置 NFS 数据存储区"]



=== 适用于 VMware VAAI 的 NetApp NFS 插件

适用于 VAAI（用于阵列集成的 vStorage API）的NetApp NFS 插件通过将某些任务卸载到NetApp存储系统来增强存储操作，从而提高性能和效率。这包括完整复制、块清零和硬件辅助锁定等操作。此外，VAAI 插件通过减少虚拟机配置和克隆操作期间通过网络传输的数据量来优化存储利用率。

可以从NetApp支持站点下载适用于 VAAI 的NetApp NFS 插件，然后使用适用ONTAP tools for VMware vSphere将其上传并安装在 ESXi 主机上。

参考 https://docs.netapp.com/us-en/nfs-plugin-vmware-vaai/["适用于 VMware VAAI 的NetApp NFS 插件文档"]了解更多信息。



=== 适用于 VMware vSphere 的 SnapCenter 插件

SnapCenter Plug-in for VMware vSphere (SCV) 是NetApp推出的一款软件解决方案，可为 VMware vSphere 环境提供全面的数据保护。它旨在简化和精简保护和管理虚拟机 (VM) 和数据存储的过程。  SCV 使用基于存储的快照和复制到辅助阵列来满足较低的恢复时间目标。

SnapCenter Plug-in for VMware vSphere在统一界面中提供以下功能，并与 vSphere 客户端集成：

*基于策略的快照* - SnapCenter允许您定义用于创建和管理 VMware vSphere 中虚拟机 (VM) 的应用程序一致性快照的策略。

*自动化*——根据定义的策略自动创建和管理快照有助于确保一致、高效的数据保护。

*虚拟机级别保护* - 虚拟机级别的细粒度保护允许对单个虚拟机进行有效的管理和恢复。

*存储效率功能* - 与NetApp存储技术集成可提供快照重复数据删除和压缩等存储效率功能，从而最大限度地减少存储需求。

SnapCenter插件可以协调虚拟机的静止状态以及NetApp存储阵列上基于硬件的快照。  SnapMirror技术用于将备份副本复制到包括云中的二级存储系统。

更多信息请参阅 https://docs.netapp.com/us-en/sc-plugin-vmware-vsphere["SnapCenter Plug-in for VMware vSphere文档"]。

BlueXP集成支持 3-2-1 备份策略，将数据副本扩展到云中的对象存储。

有关BlueXP的 3-2-1 备份策略的更多信息，请访问link:https://docs.netapp.com/us-en/netapp-solutions-cloud/vmware/vmw-hybrid-321-dp-scv.html["借助SnapCenter插件和BlueXP backup and recovery为虚拟机提供 3-2-1 数据保护"^]。

有关SnapCenter插件的分步部署说明，请参阅解决方案link:vmw-vcf-scv-viwld.html["使用SnapCenter Plug-in for VMware vSphere保护 VCF 工作负载域上的虚拟机"]。



=== 存储注意事项

利用ONTAP NFS 数据存储库和 VMware vSphere 可实现高性能、易于管理且可扩展的环境，从而提供基于块的存储协议无法实现的虚拟机与数据存储库比率。这种架构可以使数据存储密度增加十倍，同时数据存储数量相应减少。

*nConnect for NFS*：使用 NFS 的另一个好处是能够利用 *nConnect* 功能。nConnect 为 NFS v3 数据存储卷启用多个 TCP 连接，从而实现更高的吞吐量。这有助于提高并行性和 NFS 数据存储。使用 NFS 版本 3 部署数据存储的客户可以增加与 NFS 服务器的连接数量，从而最大限度地提高高速网络接口卡的利用率。

有关 nConnect 的详细信息，请参阅link:vmw-vsphere8-nfs-nconnect.html["VMware 和NetApp的 NFS nConnect 功能"]。

*NFS 会话中继：*从ONTAP 9.14.1 开始，使用 NFSv4.1 的客户端可以利用会话中继与 NFS 服务器上的各种 LIF 建立多个连接。通过利用多路径，可以实现更快的数据传输并增强弹性。当将FlexVol卷导出到支持中继的客户端（例如 VMware 和 Linux 客户端）时，或者在使用 NFS over RDMA、TCP 或 pNFS 协议时，中继特别有用。

参考 https://docs.netapp.com/us-en/ontap/nfs-trunking/["NFS 中继概述"]了解更多信息。

* FlexVol卷：* NetApp建议对大多数 NFS 数据存储使用 * FlexVol* 卷。虽然更大的数据存储库可以提高存储效率和运营优势，但建议考虑使用至少四个数据存储库（FlexVol卷）在单个ONTAP控制器上存储虚拟机。通常，管理员会部署由FlexVol卷支持的数据存储库，容量范围为 4TB 到 8TB。这种规模在性能、易于管理和数据保护之间取得了良好的平衡。管理员可以从小规模开始，并根据需要扩展数据存储（最多可达 100TB）。较小的数据存储有利于更快地从备份或灾难中恢复，并且可以在集群中快速移动。这种方法可以最大限度地利用硬件资源的性能，并支持具有不同恢复策略的数据存储。

* FlexGroup卷：*对于需要大型数据存储的场景， NetApp建议使用 * FlexGroup* 卷。 FlexGroup卷几乎没有容量或文件数量限制，使管理员能够轻松配置庞大的单一命名空间。使用FlexGroup卷不会产生额外的维护或管理开销。 FlexGroup卷的性能不需要多个数据存储，因为它们本身就可以扩展。通过将ONTAP和FlexGroup卷与 VMware vSphere 结合使用，您可以建立简单且可扩展的数据存储库，充分利用整个ONTAP集群的全部功能。



=== 勒索软件防护

NetApp ONTAP数据管理软件具有一套全面的集成技术，可帮助您保护、检测和恢复勒索软件攻击。 ONTAP内置的NetApp SnapLock Compliance功能可使用具有高级数据保留功能的 WORM（一次写入，多次读取）技术来防止删除已启用卷中存储的数据。确定保留期并锁定 Snapshot 副本后，即使具有完全系统权限的存储管理员或NetApp支持团队的成员也无法删除 Snapshot 副本。但更重要的是，拥有泄露凭证的黑客无法删除数据。

NetApp保证我们能够在符合条件的阵列上恢复您受保护的NetApp Snapshot 副本，如果我们无法恢复，我们将对您的组织进行赔偿。

有关勒索软件恢复保证的更多信息，请参阅： https://www.netapp.com/media/103031-SB-4279-Ransomware_Recovery_Guarantee.pdf["勒索软件恢复保证"] 。

请参阅 https://docs.netapp.com/us-en/ontap/anti-ransomware/["自主勒索软件防护概述"]了解更多深入信息。

请参阅 NetApps 解决方案文档中心的完整解决方案：link:vmw-nfs-arp.html["自主防御 NFS 存储勒索软件"]



=== 灾难恢复注意事项

NetApp提供全球最安全的存储。  NetApp可以帮助保护数据和应用程序基础架构，在本地存储和云之间移动数据，并帮助确保跨云的数据可用性。  ONTAP配备强大的数据保护和安全技术，可通过主动检测威胁并快速恢复数据和应用程序来帮助保护客户免受灾难。

*VMware Live Site Recovery*（以前称为 VMware Site Recovery Manager）提供简化的、基于策略的自动化功能，用于保护 vSphere Web 客户端中的虚拟机。该解决方案通过存储复制适配器（作为ONTAP Tools for VMware 的一部分）利用 NetApp 先进的数据管理技术。通过利用NetApp SnapMirror的基于阵列的复制功能，VMware 环境可以从 ONTAP 最可靠、最成熟的技术之一中受益。 SnapMirror仅复制更改的文件系统块（而不是整个虚拟机或数据存储区），从而确保安全、高效的数据传输。此外，这些块利用了重复数据删除、压缩和压缩等节省空间的技术。通过在现代ONTAP系统中引入与版本无关的SnapMirror ，您可以灵活地选择源集群和目标集群。  SnapMirror确实已成为一种强大的灾难恢复工具，并且与实时站点恢复相结合时，与本地存储替代方案相比，它提供了增强的可扩展性、性能和成本节省。

更多信息请参阅 https://techdocs.broadcom.com/us/en/vmware-cis/live-recovery/site-recovery-manager/8-7/site-recovery-manager-installation-and-configuration-8-7/overview-of-vmware-site-recovery-manager.html["VMware Site Recovery Manager 概述"]。

请参阅 NetApps 解决方案文档中心的完整解决方案：link:vmw-nfs-vlsr.html["自主防御 NFS 存储勒索软件"]

* BlueXP DRaaS*（灾难恢复即服务）是一种经济高效的灾难恢复解决方案，专为在具有 NFS 数据存储的本地ONTAP系统上运行的 VMware 工作负载而设计。它利用NetApp SnapMirror复制来防止站点中断和数据损坏事件（例如勒索软件攻击）。该服务与NetApp BlueXP控制台集成，可轻松管理和自动发现 VMware vCenters 和ONTAP存储。组织可以创建和测试灾难恢复计划，通过块级复制实现长达 5 分钟的恢复点目标 (RPO)。 BlueXP DRaaS 利用 ONTAP 的FlexClone技术进行节省空间的测试，而不会影响生产资源。该服务协调故障转移和故障恢复过程，允许以最小的努力将受保护的虚拟机启动到指定的灾难恢复站点。与其他知名替代方案相比， BlueXP DRaaS 以极低的成本提供了这些功能，使其成为组织使用ONTAP存储系统为其 VMware 环境设置、测试和执行灾难恢复操作的有效解决方案。

请参阅 NetApps 解决方案文档中心的完整解决方案：link:https://docs.netapp.com/us-en/netapp-solutions-cloud/vmware/vmw-hybrid-dr-nfs.html["使用BlueXP DRaaS 对 NFS 数据存储进行灾难恢复"^]



=== 解决方案概述

本文档涵盖的解决方案：

* *NFS nConnect 功能与NetApp和 VMware 兼容*。点击link:vmw-vsphere8-nfs-nconnect.html["*这里*"]了解部署步骤。
+
** *使用ONTAP工具 10 为 vSphere 8 配置 NFS 数据存储*。点击link:vmw-nfs-otv10.html["*这里*"]了解部署步骤。
** *部署并使用SnapCenter Plug-in for VMware vSphere来保护和恢复虚拟机*。点击link:vmw-vcf-scv-viwld.html["*这里*"]了解部署步骤。
** *使用 VMware Site Recovery Manager 进行 NFS 数据存储的灾难恢复*。点击link:vmw-nfs-vlsr.html["*这里*"]了解部署步骤。
** *NFS 存储的自主勒索软件保护*。点击link:https://docs.netapp.com/us-en/netapp-solutions-cloud/vmware/vmw-hybrid-dr-nfs.html["*这里*"^]了解部署步骤。



