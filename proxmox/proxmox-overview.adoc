---
sidebar: sidebar 
permalink: proxmox/proxmox-overview.html 
keywords: proxmox ve, kvm, qemu, lxc, vm 
summary:  
---
= 了解 Proxmox 虚拟环境
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Proxmox 虚拟环境 (VE) 是一个基于 Debian Linux 的开源 Type-1 虚拟机管理程序，能够托管虚拟机和 Linux 容器 (LXC)。了解 Proxmox VE，包括其对完整 VM 和基于容器的虚拟化、集群管理、计算和存储选项、网络功能、监控工具和数据保护策略的支持。



== 概述

Proxmox 虚拟环境 (VE) 支持同一主机上的完整 VM 和基于容器的虚拟化。基于内核的虚拟机 (KVM) 和快速模拟器 (QEMU) 用于实现完整的虚拟机虚拟化。  QEMU 是一个开源机器模拟器和虚拟化器，它使用 KVM 内核模块直接在主机 CPU 上执行客户代码。  Linux 容器 (LXC) 允许像虚拟机一样管理容器，并且数据在重启后仍能保留。

image:proxmox-overview-001.png["Proxmox 主机上的 VM 和 LXC"]

RESTful API 可用于自动化任务。有关 API 调用的信息，请查看link:https://pve.proxmox.com/pve-docs/api-viewer/index.html["Proxmox VE API 查看器"]



== 集群管理

基于 Web 的管理门户可在 Proxmox VE 节点的端口 8006 上使用。可以将多个节点连接在一起以形成一个集群。  Proxmox VE 配置， `/etc/pve` ，在集群的所有节点之间共享。 Proxmox VE 用途link:https://pve.proxmox.com/wiki/Cluster_Manager["Corosync 集群引擎"]管理集群。可以从集群的任何节点访问管理门户。

image:proxmox-overview-002.png["管理接口"]

如果托管节点发生故障，集群可以在其他节点上监控虚拟机和容器并重新启动它们。需要配置虚拟机和容器以实现高可用性 (HA)。可以通过创建组将虚拟机和容器托管在特定的主机子集上。 VM 或容器托管在优先级最高的主机上。欲了解更多信息，请查看link:https://pve.proxmox.com/wiki/High_Availability["房委会经理"]

image:proxmox-overview-003.png["HA 组优先级"]

身份验证选项包括 Linux PAM、Proxmox VE PAM、LDAP、Microsoft AD 或 OpenID。可以通过角色和使用资源池（资源集合）来分配权限。如需更多详细信息，请查看link:https://pve.proxmox.com/pve-docs/chapter-pveum.html["Proxmox用户管理"]


TIP: LDAP/Microsoft AD 的连接凭据可能以明文形式存储，并存储在需要受主机文件系统保护的文件中。



== 计算

VM 的 CPU 选项包括 CPU 核心和插槽的数量（用于指定 vCPU 的数量）、选择 NUMA 的选项、定义亲和性、设置限制和 CPU 类型。

image:proxmox-overview-011.png["VM CPU 选项"]

有关 CPU 类型及其如何影响实时迁移的指导，请查看link:https://pve.proxmox.com/pve-docs/chapter-qm.html#qm_cpu["Proxmox VE 文档的 QEMU/KVM 虚拟机部分"]

LXC 容器镜像的 CPU 选项如下面的屏幕截图所示。

image:proxmox-overview-012.png["LXC CPU 选项"]

VM和LXC可以指定内存大小。对于虚拟机，膨胀功能适用于 Linux 虚拟机。有关详细信息，请参阅link:https://pve.proxmox.com/pve-docs/chapter-qm.html#qm_memory["Proxmox VE 文档的 QEMU/KVM 虚拟机部分"]



== 存储

虚拟机由一个配置文件组成， `/etc/pve/qemu-server/<vm id>.conf`以及虚拟磁盘组件。支持的虚拟磁盘格式为 raw、qcow2 和 VMDK。  QCOW2 可以在各种存储类型上提供精简配置和快照功能。

image:proxmox-overview-004.png["虚拟机磁盘格式"]

可以选择将 iSCSI LUN 作为原始设备呈现给 VM。

LXC也有自己的配置文件， `/etc/pve/lxc/<container id>.conf`以及容器磁盘组件。可以从支持的存储类型中挂载数据卷。

image:proxmox-overview-005.png["集装箱附加支架"]

支持的存储类型包括本地磁盘、NAS（SMB 和 NFS）和 SAN（FC、iSCSI、NVMe-oF 等）。有关详细信息，请参阅link:https://pve.proxmox.com/pve-docs/chapter-pvesm.html["Proxmox VE存储"]

每个存储卷都配置了允许的内容类型。  NAS 卷支持所有内容类型，而 SAN 支持仅限于 VM 和容器映像。


NOTE: 目录存储类型也支持所有内容类型。  SMB 连接凭据以明文形式存储，只有 root 可以访问。

image:proxmox-overview-006.png["NAS 的内容类型"]

image:proxmox-overview-007.png["具有 SAN 的内容类型"]

要从 Broadcom vSphere 环境导入虚拟机，vSphere 主机也可以作为存储设备包含在内。



== 网络

Proxmox VE 支持原生 Linux 网络功能（如 Linux 桥接器或 Open vSwitch），以实现软件定义网络 (SDN)。主机上的以太网接口可以绑定在一起以提供冗余和高可用性。对于其他选项，请参阅link:https://pve.proxmox.com/pve-docs/chapter-sysadmin.html#_choosing_a_network_configuration["Proxmox VE 文档"]

image:proxmox-overview-008.png["保税网络"]

可以在集群级别配置来宾网络，并将更改推送到成员主机。通过区域、虚拟网络和子网来管理分离。link:https://pve.proxmox.com/pve-docs/chapter-pvesdn.html["分区"]定义Simple、VLAN、VLAN Stacking、VXLAN、EVPN等网络类型。

根据区域类型的不同，网络的行为会有所不同，并提供特定的功能、优势和限制。

SDN 的用例范围从每个单独节点上的独立专用网络到跨不同位置的多个 PVE 集群的复杂覆盖网络。

在集群范围的数据中心 SDN 管理界面中配置 VNet 后，它可作为每个节点本地的通用 Linux 桥分配给虚拟机和容器。

创建虚拟机时，用户可以选择要连接的 Linux 桥。创建虚拟机后可以添加其他接口。

image:proxmox-overview-013.png["虚拟机网络选择"]

这是数据中心级别的 VNet 信息。

image:proxmox-overview-014.png["数据中心的 VNet 信息"]



== 监控

大多数对象（例如数据中心、主机、虚拟机、容器、存储等）的摘要页面提供了详细信息并包含一些性能指标。以下屏幕截图显示了主机的摘要页面，其中包括有关已安装软件包的信息。

image:proxmox-overview-009.png["主机包视图"]

有关主机、客户机、存储等的统计数据可以推送到外部 Graphite 或 Influxdb 数据库。有关详细信息，请参阅link:https://pve.proxmox.com/pve-docs/chapter-sysadmin.html#external_metric_server["Proxmox VE 文档"]。



== 数据保护

Proxmox VE 包括将虚拟机和容器备份和恢复到为备份内容配置的存储的选项。可以使用工具 vzdump 从 UI 或 CLI 启动备份，也可以安排备份。有关详细信息，请参阅link:https://pve.proxmox.com/pve-docs/chapter-vzdump.html["Proxmox VE 文档的备份和恢复部分"]。

image:proxmox-overview-010.png["Proxmox VE备份存储内容"]

备份内容需要存储在异地，以防止源站点发生任何灾难。

Veeam 在 12.2 版本中增加了对 Proxmox VE 的支持。这允许将 VM 备份从 vSphere 恢复到 Proxmox VE 主机。
