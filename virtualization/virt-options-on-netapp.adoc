---
sidebar: sidebar 
permalink: virtualization/virt-options-on-netapp.html 
keywords: virtualization, overview, options, vmware, alternatives, hyperv, proxmox, openshift 
summary: 本文档概述了为什么NetApp是虚拟化环境的最佳平台 - 无论采用何种虚拟化解决方案。 
---
= 了解如何使用NetApp实现任何虚拟化解决方案
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
了解NetApp ONTAP如何为虚拟化提供强大的基础，尤其是响应最近的 VMware 许可变化。探索优化 VMware 环境、迁移到 VMware Cloud Foundation 或其他虚拟机管理程序的策略，并利用 NetApp 的高级数据管理、保护和云集成功能。



== 简介

鉴于 VMware 最近的许可证变化，组织必须调整其虚拟化策略，以最大限度地提高成本效率和可扩展性并最大限度地降低业务风险。优化现有的 VMware 环境，考虑使用现有企业存储从独立 vSphere 迁移到 VMware Cloud Foundation (VCF) 并采用多虚拟机管理程序或混合云方法是关键步骤。值得注意的是，VCF 5.2.1 通过允许使用外部存储解决方案代替 vSAN 引入了增强的灵活性，简化了组织在使用企业存储功能和保持连续性的同时采用新许可模式的能力。

ONTAP是任何本地或云中的虚拟机管理程序的最佳平台。 ONTAP支持本地环境中所有主要的虚拟机管理程序，并在每个主要云中拥有第一方数据服务，支持 VMware 云产品和云原生工作负载。这使得组织能够通过为其工作负载选择适当的部署模型来轻松应对许可变更。

本文概述了优化 VMware 部署成本的策略，评估了多虚拟机管理程序的采用情况，详细介绍了虚拟机从 vSphere 到 VCF 的迁移以及虚拟机到备用虚拟机管理程序的迁移，涵盖了所有可用选项。



== 发生了什么变化

博通收购 VMware 导致 VMware 许可模式发生重大转变。新方法正在转变为基于订阅的捆绑定价结构，虽然符合行业趋势，但预计会导致客户成本大幅增加。请记住以下三个要点：

*基于订阅的许可*：VMware 正在从永久许可转向基于订阅的模式。

*捆绑包装*：VMware Cloud Foundation (VCF) 将多种产品捆绑在一起，为企业和服务提供商提供单一产品。

*按插槽到核心*：从按插槽到按 CPU 核心定价的转变表明这是一个重大变化，可能会大幅增加成本。

*关键要点* - 这些变化促使客户评估他们的虚拟化需求，更有效地优化利用率，并探索替代方案。



== 为什么选择ONTAP

NetApp存储解决方案使客户能够充分利用虚拟化基础架构的所有优势。借助NetApp解决方案，客户可以快速部署全面的数据管理软件，提供自动化、效率、数据保护和领先的安全功能，同时满足任何苛刻的性能需求。将ONTAP软件与 VMware vSphere 相结合，可以减少主机硬件和 VMware 许可费用，确保以较低的成本保护数据，并提供一致的高性能。

虚拟化工作负载本质上是动态的。因此，管理员利用 VMware Storage vMotion 在同一存储系统内跨 VMFS、NFS 或vVols数据存储迁移虚拟机。这使他们能够探索各种存储策略，包括全闪存系统或最新的ASA模型，利用 SAN 创新来提高成本效率。

image:virt-options-001.png["NetApp ONTAP优势图"]

ONTAP存储解决方案具有以下优势：

* *独立扩展：*将工作负载数据管理、保护和移动性卸载到与 vSphere 集成的存储中，从而无需添加计算资源即可扩展存储
* *超快性能：*通过尖端的 NVMe 和ASA架构提供亚毫秒级延迟和高吞吐量。针对传统虚拟机和现代 Kubernetes 或 AI 部署优化闪存、NVMe 和 GPU 性能。
* *综合数据服务：*使用内置功能压缩、重复数据删除和压缩数据，存储量减少 5-30 倍，数据中心效率提高 85-90%
* *无缝集群和高可用性：*利用SnapMirror主动同步或MetroCluster实现轻松的延伸集群和强大的灾难恢复。
* *多协议：* ONTAP支持通过多种协议访问数据，例如 NFS、iSCSI、SMB 和 S3。运行ONTAP 的系统在几个重要方面是统一的。最初这种方法同时涉及 NAS 和 SAN 协议， ONTAP继续作为 SAN 的领先平台，同时又具有其在 NAS 方面的原有优势。
* *自动化配置和编排：*利用 VMware 的ONTAP工具及其 REST API、vSphere 插件和 SPBM（存储策略）来自动化和简化存储管理。
* *集成数据保护和低成本灾难恢复：*使用NetApp SnapCenter卸载虚拟工作负载备份和恢复。利用NetApp BlueXP disaster recovery即服务 (DRaaS) 实现更低的 RPO 并减少 RTO 数据复制。这消除了对昂贵的替代基础设施的需求，为 VMware 工作负载提供了经济实惠的灾难保护。无论是从本地到本地NetApp ONTAP环境还是到 VMware Cloud， NetApp支持的存储都能确保提供强大的保护。
* *勒索软件检测*：通过内置自主勒索软件保护和零信任兼容性，将 VMware 级安全性和合规性扩展到数据，通过启用多因素身份验证、基于角色的访问、全面日志记录和用户行为异常检测，提高保护、检测、补救和恢复能力
* *集成混合云：*简化并集成工作负载移动性、备份和恢复以及灾难恢复到任何超大规模云（Elastic VMware Service、Azure VMware Solution 和 Google Cloud VMware Engine）。
* *存储生命周期计划 (SLP)*：如果组织已准备好采取这一步骤，则可以无中断地升级到下一代控制器或选择云存储。




=== 关键要点

* 使用ONTAP卸载 CPU 密集型任务（例如存储效率、加密、快照等）来消除 ESXi 主机上的 CPU 影响和开销。这种优化减少了每台主机上所需的核心数量，从而降低了总体拥有成本 (TCO)。
* 借助ONTAP，从初始容量开始并利用卓越的数据减少和移动技术，无需添加新主机即可降低 20-50% 的成本。
* ONTAP存储可以与多个工作负载域一起使用，而不受特定集群的限制，从而提高跨多个集群的整体利用率。
* ONTAP Snapshot 与SnapCenter集成，为虚拟机和数据存储级备份以及细粒度恢复提供卓越且免费的数据保护。此外， ONTAP还支持将快照卸载到对象存储以进行长期保留。
* 体验无缝存储，无需配置 RAID 或存储池、持续的数据缩减和加密。
* 借助ONTAP One，您可以访问所有ONTAP功能和强大的安全性，而无需担心许可障碍。与NetApp BlueXP DRaaS 配对可进一步降低成本。




== 合适的规模和优化

随着这些许可变更生效，每个 IT 组织都面临着总拥有成本 (TCO) 可能增加的压力，有时甚至会超过 10 倍。经过优化的 VMware 环境可在控制许可费用的同时最大限度地提高性能。这确保了有效的资源管理和容量规划。使用正确的工具集，您可以快速识别浪费或闲置的资源以回收核心，从而减少核心数量，进而降低整体许可成本。

NetApp提供了一套强大的工具来克服这些挑战，提供增强的可视性、无缝集成、成本效益和强大的安全性。通过利用这些功能，组织可以在这种混乱中生存甚至发展，并为未来带来的任何挑战做好准备。注意：请记住，大多数组织已经将此作为其云评估的一部分，并且相同的流程和工具有助于避免内部部署世界中的成本恐慌，并节省任何由情绪驱动的迁移到替代虚拟机管理程序的成本。



=== NetApp如何提供帮助



==== NetApp TCO Estimator：NetApp 的免费 TCO 估算工具

* 基于 HTML 的简单计算器
* 使用NetApp VMDC、RVTools 或手动输入方法
* 轻松预测给定部署所需的主机数量，并计算使用NetApp ONTAP存储系统优化部署所需的节省。
* 显示可能的节省



NOTE: 这link:https://tco.solutions.netapp.com/vmwntaptco/["TCO估算器"]仅NetApp现场团队和合作伙伴可以访问。与NetApp客户团队合作评估您现有的环境。



==== VM 数据收集器 (VMDC)：NetApp 的免费 VMware 评估工具

* 轻量级、即时收集配置和性能数据
* 带有 Web 界面的简单基于 Windows 的部署
* 可视化虚拟机拓扑关系并导出 Excel 报告
* 专门针对 VMware 核心许可优化


VMDC 可用link:https://mysupport.netapp.com/site/tools/tool-eula/vm-data-collector/["此处"]。



==== Data Infrastructure Insights（以前称为Cloud Insights）

* 基于 SaaS 的跨混合/多云环境的持续监控
* 支持异构环境，包括 Pure、Dell、HPE 存储系统和 vSAN。
* 具有 AI/ML 支持的高级分析功能，可识别孤立的虚拟机和未使用的存储容量 - 部署以进行详细分析并提供虚拟机回收建议。
* 提供工作负载分析功能，以便在迁移之前调整虚拟机的大小，并确保关键应用程序在迁移之前、迁移期间和迁移之后满足 SLA。
* 提供 30 天免费试用期


借助 DII，可以使用实时指标深入分析跨虚拟机的工作负载 IO 配置文件。


NOTE: NetApp提供了一项名为“虚拟化现代化评估”的评估，它是NetApp架构和设计服务的一项功能。每个虚拟机都映射到两个轴上：CPU 利用率和内存利用率。在研讨会期间，我们将向客户提供有关内部部署优化和云迁移策略的所有详细信息，以促进有效利用资源和降低成本。通过实施这些策略，组织可以维护高性能的 VMware 环境，同时有效地管理成本。



==== 关键要点

VMDC 是实施 DII 之前的一个快速的第一步评估，用于跨异构环境进行持续监控和高级 AI/ML 驱动的分析。



==== VCF 导入工具：使用 NFS 或 FC 作为主要存储运行 VCF

随着 VMware Cloud Foundation (VCF) 5.2 的发布，可以将现有的 vSphere 基础架构转换为 VCF 管理域，并将其他集群作为 VCF VI 工作负载域导入。有了它，VMware Cloud Foundation (VCF) 现在可以在NetApp存储平台上完全运行，而无需使用 vSAN（是的，所有这些都不需要 vSAN）。转换在ONTAP上运行现有 NFS 或 FC 数据存储的集群涉及将现有基础架构集成到现代私有云中，这意味着不需要 vSAN。此过程受益于 NFS 和 FC 存储的灵活性，以确保无缝的数据访问和管理。通过转换过程建立 VCF 管理域后，管理员可以有效地将其他 vSphere 集群（包括使用 NFS 或 FC 数据存储的集群）导入 VCF 生态系统。这种集成不仅提高了资源利用率，还简化了私有云基础设施的管理，确保了平稳过渡，并且对现有工作负载的干扰最小。


NOTE: 仅用作主存储时支持 NFS v3 和 FC 协议。补充存储可以使用 vSphere 支持的 NFS 协议 v3 或 4.1。



==== 重点：

导入或转换现有的 ESXi 集群可以利用现有的ONTAP存储作为数据存储，而无需部署 vSAN 或额外的硬件资源，从而使 VCF 资源高效、成本优化和简化。



==== 使用ONTAP存储从现有 vSphere 迁移到 VCF

如果 VMware Cloud Foundation 是全新安装（创建新的 vSphere 基础架构和单点登录域），则无法从 Cloud Foundation 管理在旧 vSphere 版本上运行的现有工作负载。第一步是将现有 vSphere 环境上运行的当前应用程序虚拟机迁移到 Cloud Foundation。迁移路径取决于迁移选择（实时、温和冷迁移）以及任何现有 vSphere 环境的版本。以下是根据源存储按优先顺序排列的选项。

* HCX 是目前可用于 Cloud Foundation 工作负载移动的功能最丰富的工具。
* 利用NetApp BlueXP DRaaS
* 带有 SRM 的 vSphere 复制可以成为易于使用的 vSphere 迁移工具。
* 使用 VAIO 和 VADP 的第三方软件




==== 将虚拟机从非NetApp存储迁移到ONTAP存储

大多数情况下最简单的方法是使用 Storage vMotion。集群应该能够访问新的ONTAP SAN 或 NAS 数据存储库以及您要从中迁移虚拟机的存储（SAN、NAS 等）。过程很简单：在 vSphere Web Client 中选择一个或多个虚拟机，右键单击选择，然后单击“迁移”。选择“仅存储”选项，选择新的ONTAP数据存储作为目标，然后继续执行迁移向导的最后几个步骤。vSphere 会将文件（VMX、 NVRAM、VMDK 等）从旧存储复制到由ONTAP支持的数据存储。请注意，vSphere 可能会复制大量数据。此方法不需要任何停机时间。虚拟机在迁移过程中继续运行。其他选项包括基于主机的迁移和第三方复制来执行迁移。



==== 使用存储快照进行灾难恢复（通过存储复制进一步优化）

NetApp提供业界领先的基于 SaaS 的灾难恢复 (DRaaS) 解决方案，可以显著降低成本并减少复杂性。无需购买和部署昂贵的替代基础设施。

通过从生产站点到灾难恢复站点的块级复制来实现灾难恢复是一种有弹性且经济高效的方法，可以保护工作负载免受站点中断和数据损坏事件（例如勒索软件攻击）的影响。使用NetApp SnapMirror复制，在具有 NFS 或 VMFS 数据存储区的本地ONTAP系统上运行的 VMware 工作负载可以复制到位于指定恢复数据中心的另一个ONTAP存储系统，该数据中心也部署了 VMware。

使用BlueXP disaster recovery服务，该服务集成到NetApp BlueXP控制台中，客户可以在其中发现其内部部署的 VMware vCenter 以及ONTAP存储、创建资源组、创建灾难恢复计划、将其与资源组关联以及测试或执行故障转移和故障恢复。 SnapMirror提供存储级块复制，使两个站点保持最新的增量更改，从而使 RPO 达到最长 5 分钟。还可以将 DR 过程模拟为常规演习，而不会影响生产和复制的数据存储或产生额外的存储成本。  BlueXP disaster recovery利用 ONTAP 的FlexClone技术，从 DR 站点上最后复制的快照创建 NFS 或 VMFS 数据存储库的空间高效副本。 DR 测试完成后，只需删除测试环境，同样不会对实际复制的生产资源产生任何影响。当需要（计划内或计划外）进行实际故障转移时，只需单击几下， BlueXP disaster recovery服务就会协调所需的所有步骤，自动在指定的灾难恢复站点上启动受保护的虚拟机。该服务还将逆转与主站点的SnapMirror关系，并在需要时将任何更改从辅助站点复制到主站点以进行故障恢复操作。与其他知名替代方案相比，所有这些都只需花费一小部分成本即可实现。


NOTE: 支持复制功能的第三方备份产品和带有 SRA 的 VMware Live Recovery 是其他突出的替代选择。



==== 勒索软件

尽早检测勒索软件对于防止其传播和避免代价高昂的停机至关重要。有效的勒索软件检测策略必须在 ESXi 主机和客户 VM 级别纳入多层保护。虽然实施了多种安全措施来全面防御勒索软件攻击，但ONTAP能够在整体防御方法中添加更多层保护。举几个功能的例子，它首先包括快照、自主勒索软件保护和防篡改快照。

让我们看看上述功能如何与 VMware 配合使用来保护数据并恢复数据以抵御勒索软件的攻击。

为了保护 vSphere 和客户虚拟机免受攻击，必须采取多项措施，包括分段、利用端点的 EDR/XDR/SIEM、安装安全更新并遵守适当的强化指南。驻留在数据存储上的每个虚拟机还托管一个标准操作系统。确保企业服务器安装反恶意软件产品套件并定期更新，这是多层勒索软件保护策略的重要组成部分。除此之外，在为数据存储提供支持的 NFS 卷上启用自主勒索软件保护 (ARP)。  ARP 利用内置的 onbox ML 查看卷工作负载活动和数据熵来自动检测勒索软件。  ARP 可通过ONTAP内置管理界面或系统管理器进行配置，并按卷启用。

除了多层方法之外，还有一个本机内置ONTAP解决方案，用于保护未经授权删除备份 Snapshot 副本。它被称为多管理员验证或 MAV，在ONTAP 9.11.1 及更高版本中可用。理想的方法是使用查询来执行 MAV 特定的操作。


NOTE: 有了新的NetApp ARP/AI，就不再需要学习模式。相反，它可以利用其人工智能勒索软件检测功能直接进入主动模式。



==== 关键要点

使用ONTAP One，所有作为附加层的安全功能集都是完全免费的。访问 NetApp 强大的数据保护、安全套件以及ONTAP提供的所有功能，无需担心许可障碍。



== 值得考虑的 VMware 替代方案

每个组织都在评估多虚拟机管理程序方法，该方法支持多供应商虚拟机管理程序策略，从而增强运营灵活性、减轻对供应商的依赖性并优化工作负载安排。通过组合多个虚拟机管理程序，组织可以定制基础设施以满足不同的工作负载需求，同时管理成本。然后，组织通过利用互操作性、经济高效的许可和自动化来简化多虚拟机管理程序管理。 ONTAP是任何虚拟机管理程序平台的理想平台。这种方法的一个关键要求是基于 SLA 和工作负载放置策略的动态虚拟机移动性。



=== 采用多虚拟机管理程序的关键考虑因素

* *战略成本优化：*减少对单一供应商的依赖可优化运营和许可费用。
* *工作负载分配：*为正确的工作负载部署正确的虚拟机管理程序可最大限度地提高效率。
* *灵活性：*支持根据业务应用需求优化虚拟机以及数据中心的现代化和整合。


在本节中，我们将按优先级顺序简要介绍一下组织考虑的不同虚拟机管理程序。


NOTE: 这些是组织考虑的常见替代方案，但每个客户的优先顺序会根据其评估、技能和工作量要求而有所不同。

image:virt-options-002.png["NetApp支持的虚拟化选项图"]



=== Hyper-V（Windows 服务器）

让我们来探索一下：

* Windows Server 版本中一个众所周知的内置功能。
* 为 Windows Server 中的虚拟机启用虚拟化功能。
* 当与 System Center 套件（包括 SCVMM 和 SCOM）的功能集成时，Hyper-V 提供了一套可与其他虚拟化解决方案相媲美的全面功能。




==== 集成

* NetApp SMI-S Provider将 SAN 和 NAS 的动态存储管理与 System Center Virtual Machine Manager (SCVMM) 相集成。
* 许多第三方备份合作伙伴还支持集成ONTAP快照和SnapMirror支持，以实现完全优化的阵列原生备份和恢复。
* ONTAP仍然是唯一允许在 SAN 和 NAS 之间进行本机副本卸载以实现灵活性和存储消耗的数据基础设施系统，并且ONTAP还提供跨 NAS（通过 SMB/CIFS 的 SMB3 TRIM）和 SAN（iSCSI 和带有 SCSI UNMAP 的 FCP）协议的本机空间回收。
* SnapManager for Hyper-V用于精细备份和恢复（需要 PVR 支持）。如果符合以下条件，Hyper-V 可能是一个可行的选择：
* 最近升级到新硬件或对内部基础设施进行了大量投资。
* 使用 SAN 或 NAS 进行存储（Azure Stack HCI 不是一种选择）
* 需要存储和计算独立增长由于硬件投资、政治格局、法规遵从性、应用程序开发或其他现有障碍等因素而无法实现现代化




=== OpenShift 虚拟化（RedHat KubeVirt 实现）

让我们来探索一下：

* 使用 KVM 虚拟机管理程序，在容器中运行，以 Pod 形式管理
* 由 Kubernetes 调度、部署和管理
* 使用 OpenShift Web 界面创建、修改和销毁虚拟机及其资源
* 与容器编排器资源和服务集成，实现持久存储范例。




==== 集成

* Trident CSI 允许以 VM 粒度和分类的方式动态管理 NFS、FC、iSCSI 和 NVMe/TCP 上的存储。
* Trident CSI 用于配置、快照创建、卷扩展和克隆创建
* Trident Protect 支持 OpenShift 虚拟化虚拟机的崩溃一致性备份和恢复，并将它们存储在任何与 S3 兼容的对象存储桶中。
* Trident Protect 还通过存储复制和 OpenShift 虚拟化虚拟机的自动故障转移和故障恢复提供灾难恢复。


如果符合以下情况，OpenShift 虚拟化可能有意义：

* 将虚拟机和容器整合到单一平台。
* 减少许可开销，因为 OpenShift 虚拟化是 OpenShift 的一部分，而 OpenShift 可能已经获得容器工作负载的许可。
* 将旧式虚拟机迁移到云原生生态系统中，无需第一天进行完全重构。




=== Proxmox 虚拟环境（Proxmox VE）

让我们来探索一下：

* 适用于 Qemu KVM 和 LXC 的全面开源虚拟化平台
* 基于Linux发行版Debian
* 既可以作为独立机器运行，也可以在由多台机器组成的集群中运行
* 简单、高效地部署虚拟机和容器
* 用户友好的基于 Web 的管理界面和实时迁移和备份选项等功能。




==== 集成

* 使用 iSCSI、NFS v3、v4.1 和 v4.2。
* ONTAP提供的所有出色功能，例如快速克隆、快照和复制。
* 使用 nconnect 选项，对于高 NFS 工作负载，每个服务器的 TCP 连接数最多可以增加到 16 个


如果符合以下情况，Proxmox 可能有意义：

* 开源，免除许可费用。
* 易于使用的 Web 界面简化了管理。
* 同时支持虚拟机和容器，提供灵活性。
* 单一界面管理虚拟机、容器、存储和网络
* 不受限制地访问所有功能
* 通过 Credativ 提供专业服务和支持




=== VMware Cloud 产品（Azure VMWare 解决方案、Google Cloud VMware Engine、AWS 上的 VMware Cloud、Elastic VMware 服务）

让我们来探索一下：

* VMware in the Cloud 提供托管在相应超大规模数据中心的“私有云”，该数据中心利用专用裸机基础架构来托管 VMware 基础架构。
* 每个集群最多可容纳 16 个主机，并具有 VMware 功能，包括 vCenter、vSphere、vSAN 和 NSX
* 快速部署和扩大/缩小规模
* 灵活的购买选项：按小时按需购买、1 年和 3 年预留实例，某些超大规模企业还提供 5 年选项。
* 提供熟悉的工具和流程，帮助实现从本地 VMware 到云中的 VMware 的迁移。




==== 集成


NOTE: NetApp是唯一一家在三大超大规模数据中心中提供由 VMware 在云中支持的首方集成高性能存储的外部存储供应商。

* 每个云中的NetApp支持的存储（Azure NetApp Files、FSx for ONTAP、Google Cloud NetApp卷）补充了 vSAN 存储，而不必添加额外的计算节点。
* 性能稳定、计量文件存储服务
* 高效的快照和克隆，可快速大规模创建副本和检查点更改
* 基于增量块传输的高效复制，用于区域灾难恢复和备份
* 使用NetApp支持的云存储作为数据存储，存储密集型应用程序的运行成本将更低
* 除外部数据存储连接外，还能够挂载客户机管理的客户机自有文件系统（如 NFS 或 iSCSI），以实现高性能工作负载


迁移到 VMware Cloud 产品的原因：

* 存储密集型部署通过卸载存储容量而不是添加更多计算节点来节省成本
* 与过渡到 Hyper-V、Azure Stack 甚至本机 VM 格式相比，所需的技能提升较少
* 锁定价格，最长 3 年或 5 年内不会受到其他许可成本变化的影响（取决于云提供商）。
* 提供 BYOL（自带许可）覆盖
* 从内部部署中提升并转移有助于降低关键领域的成本。
* 构建或转移灾难恢复功能至云端，降低成本并消除运营负担


对于希望在任何超大规模服务器上使用 VMware Cloud 作为灾难恢复目标的客户，可以使用ONTAP存储支持的数据存储区（Azure NetApp Files、FSx ONTAP、Google Cloud NetApp卷）通过任何经过验证的提供 VM 复制功能的第三方解决方案从本地复制数据。通过添加由ONTAP存储提供支持的数据存储区，它将在具有较少 ESXi 主机数量的目标上实现成本优化的灾难恢复。这也使得在本地环境中停用辅助站点成为可能，从而显著节省成本。

* 查看详细指南link:https://docs.netapp.com/us-en/netapp-solutions-cloud/vmware/vmw-aws-fsxn-vmc-ds-dr-veeam.html["灾难恢复至 FSx ONTAP数据存储"^]。
* 查看详细指南link:https://docs.netapp.com/us-en/netapp-solutions-cloud/vmware/vmw-azure-avs-dr-jetstream.html["灾难恢复到Azure NetApp Files数据存储"^]。
* 查看详细指南link:https://docs.netapp.com/us-en/netapp-solutions-cloud/vmware/vmw-gcp-gcve-app-dr-ds-veeam.html["灾难恢复至Google Cloud NetApp Volumes数据存储区"^]。




=== 云原生虚拟机


NOTE: NetApp是唯一一家在所有 3 个主要超大规模数据中心中都拥有第一方集成高性能多协议云存储的供应商。

让我们来探索一下：

* 通过灵活的虚拟机大小优化计算资源，以满足特定的业务需求并消除不必要的开支。
* 利用云的灵活性平稳过渡到未来。迁移到采用NetApp存储的云原生虚拟机的原因：
* 利用企业存储功能，如精简配置、存储效率、零占用克隆、集成备份、块级复制、分层，从而优化迁移工作，并从第一天起实现面向未来的部署
* 通过整合ONTAP并使用其提供的成本优化功能，优化云中原生云实例上使用的当前存储部署
* 节省成本的能力
+
** 使用ONTAP数据管理技术
** 通过对众多资源的保留
** 通过突发虚拟机和现货虚拟机


* 利用人工智能/机器学习等现代技术
* 与块存储解决方案相比，通过调整云实例的大小以满足必要的 IOP 和吞吐量参数，可以降低实例总体拥有成本 (TCO)。




=== Azure Local 或 AWS Outpost 或任何其他 HCI 模型

让我们来探索一下：

* 在经过验证的解决方案上运行
* 可在场所内部署的打包解决方案，可作为混合云或多云的核心。
* 为用户提供针对任何环境（本地、云或混合）定制的云基础设施、服务、API 和工具的访问权限。



NOTE: 必须拥有或租赁/购买与 HCI 兼容的硬件。


NOTE: Azure 本地不支持外部存储，但 AWS Outpost 支持ONTAP

迁移到 Azure Local 或 AWS Outpost 的原因：

* 如果已经拥有 HCI 兼容硬件
* 控制工作负载的执行和数据存储。
* 使用相应的服务、工具和 API 满足本地数据驻留并在本地区域处理数据
* 使用来宾连接存储为来宾虚拟机提供 iSCSI、NFS 和 SMB 连接。


缺点：

* 并非所有选项都支持 SAN、NAS 或独立存储配置
* 不支持存储和计算的独立扩展




=== 客户环境中正在考虑的其他虚拟机管理程序选项

* *KVM* 通常在每个父 Linux 发行版上都支持ONTAP ，只需参考IMT即可获得参考 Linux。
* *SUSE Harvester* 是一种现代超融合基础设施 (HCI) 解决方案，使用企业级开源技术（包括 Linux、KVM、Kubernetes、KubeVirt 和 Longhorn）为裸机服务器构建。  Harvester 专为寻求灵活且经济实惠的解决方案以在数据中心和边缘运行云原生和虚拟机 (VM) 工作负载的用户而设计，它为虚拟化和云原生工作负载管理提供了单一管理平台。  NetApp Astra Trident CSI 驱动程序引入 Harvester 集群后， NetApp存储系统可以存储在 Harvester 中运行的虚拟机可用的存储卷。
* *Red Hat OpenStack Platform* 和 OpenStack 总体来说也是一个令人难以置信的私有云解决方案，而NetApp Unified Driver 已融入上游 OpenStack 代码，这意味着NetApp数据管理集成已内置其中。也就是说，无需安装任何东西！存储管理功能支持块协议的NVMe、iSCSI或FC，以及NAS的NFS。精简配置、动态存储管理、副本卸载和快照均受原生支持。




==== 关键要点

ONTAP是适合任何内部部署虚拟机管理程序或云中任何工作负载的平台。 ONTAP支持本地环境中的知名虚拟机管理程序，并在每个云中广泛采用第一方产品。这使得客户能够通过浏览适当的部署模型轻松处理许可变更。

image:virt-options-003.png["图表展示了 NetApp 的 Any to Any 虚拟化方法"]

总而言之，VMware 仍然是组织事实上的虚拟机管理程序。然而，每个 IT 组织都在评估替代方案，并且ONTAP将在他们选择的任何选项中发挥重要作用。



== 超快（100 倍速度）迁移



=== Shift 工具包

如上所述，VMware、Microsoft Hyper-V、Proxmox 和 OpenShift Virtualization 等解决方案已成为满足虚拟化需求的强大而可靠的选择。鉴于业务需求是动态的，虚拟化平台的选择也必须具有适应性，并且即时虚拟机移动性变得重要。

从一个虚拟机管理程序迁移到另一个虚拟机管理程序对于企业来说是一个复杂的决策过程。主要考虑因素包括应用程序依赖性、迁移时间表、工作负载关键性以及应用程序停机对业务的影响。然而，有了ONTAP存储和 Shift 工具包，这一切都变得轻而易举。

NetApp Shift 工具包是一种易于使用的图形用户界面 (GUI) 解决方案，允许在不同的虚拟机管理程序之间迁移虚拟机 (VM) 并转换虚拟磁盘格式。它利用NetApp FlexClone技术快速转换 VM 硬盘。此外，该工具包还管理目标虚拟机的创建和配置。

有关详细信息，请参阅link:../migration/shift-toolkit-overview.html["在虚拟化环境之间迁移虚拟机（VM）（Shift Toolkit）"]。

image:virt-options-004.png["显示NetApp Shift Toolkit 转换选项的图表"]


NOTE: Shift 工具包的先决条件是让虚拟机在ONTAP存储上的 NFS 卷上运行。这意味着如果虚拟机托管在基于块的ONTAP存储（特别是ASA）或第三方存储上，则应使用 Storage vMotion 将虚拟机移动到指定的基于ONTAP的 NFS 数据存储区。  Shift 工具包可在此处下载，仅适用于 Windows 系统。



=== Cirrus 数据迁移操作

Shift 工具包的替代方案是依赖于块级复制的基于合作伙伴的解决方案。 Cirrus Data 可以将工作负载从传统的虚拟机管理程序无缝迁移到现代平台，从而实现更灵活的混合工作负载、加速现代化进程并提高资源利用率。link:https://action.cirrusdata.com/virtualization-optimization#:~:text=Migrate%20from%20leading%20hypervisors%20with%20just%20a%20click.,from%20Amazon%20Web%20Services%20%28AWS%29%20and%20Microsoft%20Azure.["Cirrus 迁移云"]与 MigrateOps 一起，使组织能够通过安全、易于使用且可靠的解决方案自动从一个虚拟机管理程序转换到另一个虚拟机管理程序。

*关键要点：*将虚拟机从 VMware 迁移到另一个虚拟机管理程序有多种选择。举几个例子——Veeam、Commvault、StarWind、SCVMM 等等。这里的目标是展示可能的选项，但是，Shift 工具包将提供数量级最快的迁移选项。根据具体情况，可以采用替代的迁移选项。



== 通用预计部署模型（在多虚拟机管理程序环境中）

一位客户拥有包含 10,000 台虚拟机（Windows 和 Linux 工作负载混合）的大规模虚拟化环境。为了优化许可成本并简化虚拟化基础设施的未来，多虚拟机管理程序和虚拟机放置策略非常重要。他们根据工作负载的关键性、操作系统类型、性能要求、虚拟机管理程序功能和许可成本选择了虚拟机放置策略。

组织策略分为三个虚拟机管理程序：

* VMware vSphere → 支持关键业务应用程序的关键工作负载仍保留在 VMware 上
* Microsoft Hyper-V → 5,000 个 Windows VM 迁移到 Hyper-V，利用 Windows 许可优势
* OpenShift 虚拟化 → 3,000 个 Linux VM 迁移到这里，以实现成本效益和 Kubernetes 原生管理。


这种多虚拟机管理程序方法平衡了成本、性能和灵活性，确保关键工作负载保留在 VMware 上，同时 Windows 和 Linux 工作负载使用 Shift 工具包迁移到优化的虚拟机管理程序平台，以实现效率和可扩展性。以上是一个例子，然而，可以在每个应用程序级别应用不同的排列组合来优化环境。



== 结束语

在收购 Broadcom 之后，VMware 的客户正面临复杂的集成、性能优化和成本管理环境。 NetApp提供了一套强大的工具和功能来克服这些挑战，提供增强的可视性、无缝集成、成本效益和强大的安全性。通过使用这些功能，您可以继续使用 VMware，启用多供应商方法，并为未来的中断做好准备。

利用 VMware Cloud Foundation 5.2.1 及更高版本，企业可以采用现代私有云实践，而不受 vSAN 的限制。这有助于从现有 vSphere 环境无缝迁移，同时保护对ONTAP存储的投资。

此外，集成多虚拟机管理程序策略可确保组织控制其虚拟化路线图、降低成本并根据每个工作负载的独特需求定制其基础设施。 Hyper-V、OpenShift Virtualization、Proxmox 和 KVM 各自具有独特的优势。为了确定最佳匹配，请评估预算、现有基础设施、性能要求和支持需求等因素。无论选择哪种虚拟机管理程序平台，也无论它位于何处（本地或云端）， ONTAP都是最佳存储。
